using System.Collections.Generic;
using System.Threading.Tasks;
using Skad.Common.Api.Common;
using Skad.VulnFeed.Data.Model;

namespace Skad.VulnFeed.Domain.Repository
{
    public interface IVulnerabilityFeedRepository
    {
        Task<Vulnerability> AddOrUpdateVulnerability(Vulnerability vulnerability);
        Task<Vulnerability?> FindVulnerabilityById(long id);
        Task<(PageInfo pageInfo, List<Vulnerability> vulnerabilities)> GetVulnerabilitiesWithFilter(string? cveId, int pageNum, int pageSize);
        Task AddComponentToFeed(string cpe);
        Task RemoveComponentFromFeed(string cpe);
        Task<(PageInfo pageInfo, List<VulnerableComponentSummary> vulnerabilities)> GetVulnerabilityFeedItems(int pageNum, int pageSize);
    }
}