using System.Collections.Generic;
using System.Threading.Tasks;
using Skad.Common.Api.Common;
using Skad.VulnFeed.Data.Model;

namespace Skad.VulnFeed.Domain.Service
{
    public interface IVulnerabilityFeedService
    {
        Task<Vulnerability> AddOrUpdateVulnerability(Vulnerability vuln);
        Task<Vulnerability?> GetVulnerability(long id);
        Task<(PageInfo pageInfo, List<Vulnerability> vulnerabilities)> GetVulnerabilities(string? cveId, int pageNum,
            int pageSize);
        Task AddComponentToFeed(string cpe);
        Task RemoveComponentFromFeed(string cpe);
        Task<(PageInfo pageInfo, List<VulnerableComponentSummary> vulnerabilities)> GetVulnerabilityFeedItems(int pageNum, int pageSize);
    }
}