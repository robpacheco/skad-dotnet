using System;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Skad.VulnFeed.Domain.Service;

namespace Skad.VulnFeed.ApiControllers
{
    [ApiController]
    [Route("api/vulnerability-feeds")]
    public class VulnerabilityFeedController : Controller
    {
        private readonly IVulnerabilityFeedService _vulnerabilityFeedService;

        public VulnerabilityFeedController(IVulnerabilityFeedService vulnerabilityFeedService)
        {
            _vulnerabilityFeedService = vulnerabilityFeedService ?? throw new ArgumentNullException(nameof(vulnerabilityFeedService));
        }
        
        [HttpPost]
        public async Task AddComponentToFeed([FromQuery] string cpe)
        {
            await _vulnerabilityFeedService.AddComponentToFeed(cpe);
        }

        [HttpDelete]
        public async Task RemoveComponentFromFeed([FromQuery] string cpe)
        {
            await _vulnerabilityFeedService.RemoveComponentFromFeed(cpe);
        }
    }
}