using System;
using Skad.Common.Api;
using Skad.Common.Http;

namespace Skad.VulnFeed.ApiControllers.Endpoints
{
    public class VulnerabilityFeedEndpoints
    {
        private readonly LinkGenerator _linkGenerator;

        public VulnerabilityFeedEndpoints(LinkGenerator linkGenerator)
        {
            _linkGenerator = linkGenerator ?? throw new ArgumentNullException(nameof(linkGenerator));
        }

        public string? VulnerabilityLocation(long vulnerabilityId)
        {
            if (vulnerabilityId == default)
            {
                return null;
            }

            return _linkGenerator.GenerateUri("api/vulnerabilities", $"{vulnerabilityId}").ToString();
        }
        
        public string? VulnerabilityFeedLocation(long vulnerabilityFeedId)
        {
            if (vulnerabilityFeedId == default)
            {
                return null;
            }

            return _linkGenerator.GenerateUri("api/vulnerability-feeds", $"{vulnerabilityFeedId}").ToString();
        }
    }
}